/**
 * Interstate Analytics
 *
 * Created: Jul 13, 2015 19:18:42 +0000
 * Project: 0b318fd14d7aba6eb57ffac93b375f07f1300325
 */
this.interstate=function(asyncCalls){var interstate={};interstate.passedData={projectToken:"0b318fd14d7aba6eb57ffac93b375f07f1300325",versionDate:"2015-06-09"},"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,r,i,a,s,o=gap,u=e[t];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(t)),"function"==typeof rep&&(u=rep.call(e,t,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?u+"":"null";case"boolean":case"null":return u+"";case"object":if(!u)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(u)){for(a=u.length,n=0;a>n;n+=1)s[n]=str(n,u)||"null";return i=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+o+"]":"["+s.join(",")+"]",gap=o,i}if(rep&&"object"==typeof rep)for(a=rep.length,n=0;a>n;n+=1)"string"==typeof rep[n]&&(r=rep[n],i=str(r,u),i&&s.push(quote(r)+(gap?": ":":")+i));else for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(i=str(r,u),i&&s.push(quote(r)+(gap?": ":":")+i));return i=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+o+"}":"{"+s.join(",")+"}",gap=o,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(t,e){var n,r,i=t[e];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),void 0!==r?i[n]=r:delete i[n]);return reviver.call(t,e,i)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),interstate.singletons=[],interstate.singletons.push("logger"),interstate.logger={},interstate.logger.logHistory=[],interstate.logger.LEVELS={info:0,log:1,warn:2,error:3},interstate.logger.level=interstate.logger.LEVELS.warn,interstate.logger.initialize=function(){var t=interstate.util.getQueryParameter("interstate_log_level");interstate.util.isDefAndNotNull(t)&&""!==t&&this.setLogLevel(t)},interstate.logger.getHistory=function(){return interstate.logger.logHistory},interstate.logger.info=function(t,e,n){this.logHistory.push({severity:"info",category:t,explanation:e,metadata:n,at:new Date}),this.level<=this.LEVELS.info&&this.output(t,e)},interstate.logger.setLogLevel=function(t){interstate.util.isNumber(t)||(t=this.LEVELS[t]),this.level=t},interstate.logger.log=function(t,e,n){this.logHistory.push({severity:"log",category:t,explanation:e,metadata:n,at:new Date}),this.level<=this.LEVELS.log&&this.output(t,e)},interstate.logger.warn=function(t,e,n){this.logHistory.push({severity:"warn",category:t,explanation:e,metadata:n,at:new Date}),this.level<=this.LEVELS.warn&&this.output(t,e)},interstate.logger.error=function(t,e,n){throw this.logHistory.push({severity:"error",category:t,explanation:e,metadata:n,at:new Date}),this.level<=this.LEVELS.error&&this.output(t,e),e},interstate.logger.output=function(t,e){window&&window.console&&window.console.log&&window.console.log("Interstate ("+t+") - "+e)},interstate.singletons.push("api"),interstate.api={},interstate.api.initialize=function(){this["export"]={alias:interstate.util.bind(interstate.user.alias,interstate.user),identify:interstate.util.bind(interstate.user.customerCallsIdentify,interstate.user),push:interstate.util.bind(interstate.api.callApi,interstate.api),track:interstate.util.bind(interstate.tracker.track,interstate.tracker),trackGoal:interstate.util.bind(interstate.tracker.trackGoal,interstate.tracker),trackPurchase:interstate.util.bind(interstate.tracker.trackPurchase,interstate.tracker),trackVisit:interstate.util.bind(interstate.tracker.trackVisit,interstate.tracker),getIdentifier:interstate.util.bind(interstate.user.getIdentifier,interstate.user),getLogHistory:interstate.util.bind(interstate.logger.getHistory,interstate.logger),setLogLevel:interstate.util.bind(interstate.logger.setLogLevel,interstate.logger),getAliases:interstate.util.bind(interstate.user.getAliases,interstate.user)}},interstate.api.callApi=function(t){"string"==typeof t&&(t=[t]);var e=t[0],n=this["export"][e];n||interstate.logger.error("api","API function '"+e+"' does not exist");var r=t.slice(1);return interstate.logger.log("api","Calling API function "+e,r),n.apply(null,r)},interstate.singletons.push("async"),interstate.async={},interstate.async.runAllAsyncCalls=function(t){for(var e=0;e<t.length;e++)interstate.api.callApi(t[e])},interstate.singletons.push("cookie"),interstate.cookie={},interstate.cookie.cookieKey=function(){return"interstate_v2_"+interstate.passedData.projectToken},interstate.cookie.setCookieHash=function(t,e){var n=new Date;n.setTime(n.getTime()+24*e*60*60*1e3);var r="expires="+n.toGMTString(),i=encodeURIComponent(JSON.stringify(t)),a=this.cookieKey(),s=(location.host.match(/\./g)||[]).length>1?location.host.substring(location.host.indexOf(".")):"."+location.host;document.cookie=a+"="+i+"; Domain="+s+";"+r+"; path=/";var o=this.getRawCookie(a);o&&o===i||(document.cookie=a+"="+i+";"+r+"; path=/")},interstate.cookie.getCookieHash=function(t){try{var e=t||interstate.cookie.cookieKey();e+="=";for(var n=document.cookie.split(";"),r=0;r<n.length;r++)if(n[r]){var i=n[r].replace(/^\s+|\s+$/g,"");if(0==i.indexOf(e))return JSON.parse(decodeURIComponent(i.substring(e.length,i.length)))}return{}}catch(a){return{}}},interstate.cookie.getRawCookie=function(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return null},interstate.cookie.getCookie=function(t){var e=interstate.cookie.getCookieHash();return e[t]},interstate.cookie.deleteCookie=function(t){document.cookie=t+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/"},interstate.cookie.setCookie=function(t,e,n){var r=interstate.cookie.getCookieHash();r[t]=e,interstate.cookie.setCookieHash(r,n)},interstate.cookie.setCookies=function(t,e){var n=interstate.cookie.getCookieHash();for(key in t)t.hasOwnProperty(key)&&(n[key]=t[key]);interstate.cookie.setCookieHash(n,e)},interstate.singletons.push("util"),interstate.util={},interstate.util.bind=function(t,e){if(!t)throw new Error;if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),t.apply(e,r)}}return function(){return t.apply(e,arguments)}},interstate.util.contains=function(t,e){for(var n=t.length;n--;)if(t[n]===e)return!0;return!1},interstate.util.urlParams=function(){var t={},e=window.location.search.substring(1);if(e)for(var n=e.split("&"),r=0;r<n.length;r++){var i=n[r].split("=");2===i.length&&(t[i[0]]=decodeURIComponent(i[1].replace(/\+/g,"%20")))}return t},interstate.util.getQueryParameter=function(t){return decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null},interstate.util.isDefAndNotNull=function(t){return null!=t},interstate.util.isNumber=function(t){return interstate.util.isDefAndNotNull(t)&&!isNaN(parseFloat(t))&&isFinite(t)},interstate.util.extendObjects=function(t){var e=arguments.length;if(2>e||null==t)return t;for(var n=1;e>n;n++){var r=arguments[n];for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t},interstate.util.randomGUID=function(){var t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return t()+t()+"-"+t()+t()+"-"+t()+t()+"-"+t()+t()},interstate.singletons.push("user"),interstate.user={},interstate.user.ALIASES_COOKIE_KEY="aliases",interstate.user.IDENTIFIER_COOKIE_KEY="user_identifier",interstate.user.BAD_ALIAS_NAMES=["","null","undefined","n/a","none","nil","empty","0"],interstate.user.identifier=null,interstate.user.initialize=function(){this.ensureIdentifierExists()},interstate.user.alias=function(t){return interstate.util.isDefAndNotNull(t)?(t=String(t),interstate.util.contains(interstate.user.BAD_ALIAS_NAMES,t)?(interstate.logger.warn("User","Not processing alias name '"+t+"' because it seems bad."),!1):(interstate.user.saveAlias(t),void interstate.tracker.sendMessage({aliased_name:t},"alias_user"))):(interstate.logger.warn("User","Should pass a defined and non-null alias name to the alias method."),!1)},interstate.user.getAliases=function(){var t=interstate.cookie.getCookie(interstate.user.ALIASES_COOKIE_KEY)||[];return t},interstate.user.saveAlias=function(t){var e=this.getAliases();interstate.util.contains(e,t)||(e.push(t),e.length>10&&e.shift(),interstate.cookie.setCookie(interstate.user.ALIASES_COOKIE_KEY,e,365))},interstate.user.customerCallsIdentify=function(t){this.alias(t)},interstate.user.ensureIdentifierExists=function(){if(!this.identifier){var t=this.getCookiedIdentifier();if(t)return void(this.identifier=t);this.identifier=this.getSegmentIdentifier()||interstate.util.randomGUID(),this.saveIdentifierCookie()}},interstate.user.getIdentifier=function(){return this.ensureIdentifierExists(),this.identifier},interstate.user.getCookiedIdentifier=function(){return interstate.cookie.getCookie(interstate.user.IDENTIFIER_COOKIE_KEY)},interstate.user.saveIdentifierCookie=function(){var t=this.getCookiedIdentifier();t!==this.identifier&&interstate.cookie.setCookie(interstate.user.IDENTIFIER_COOKIE_KEY,this.identifier,365),interstate.cookie.setCookie("last_updated",(new Date).getTime(),365)},interstate.user.getSegmentIdentifier=function(){var t=window.analytics;return t&&t.user&&"function"==typeof t.user&&"function"==typeof t.user().anonymousId?t.user().anonymousId():null},interstate.singletons.push("tracker"),interstate.tracker={},interstate.tracker.initialize=function(){interstate.user.ensureIdentifierExists(),interstate.tracker.trackVisit()},interstate.tracker.track=function(t,e){e=e||{},interstate.util.isNumber(e)&&(e={price:e}),e=interstate.util.extendObjects(e,interstate.tracker.campaignParams()),e.conversion_name=t,interstate.util.isDefAndNotNull(e.revenue)&&(e.price=e.revenue,delete e.revenue),interstate.tracker.sendMessage(e,"conversion")},interstate.tracker.trackVisit=function(){var t,e,n,r,i;t=interstate.util.getQueryParameter("utm_campaign"),e=interstate.util.getQueryParameter("utm_medium"),n=interstate.util.getQueryParameter("utm_source"),r=interstate.util.getQueryParameter("utm_term"),i=interstate.util.getQueryParameter("utm_content"),t||e||n||r||i?(interstate.cookie.setCookies({utm_campaign:t,utm_source:n,utm_medium:e,utm_term:r,utm_content:i},365),interstate.tracker.sendMessage(interstate.tracker.campaignParams(),"visit")):(interstate.cookie.setCookies({utm_campaign:null,utm_source:null,utm_medium:null,utm_term:null,utm_content:null},365),interstate.tracker.sendMessage(interstate.tracker.campaignParams(),"visit")),interstate.cookie.setCookie("last_visit",(new Date).getTime(),365)},interstate.tracker.trackPurchase=function(t,e){interstate.tracker.trackConversion("purchase",t,e)},interstate.tracker.trackConversion=function(t,e,n){var r=interstate.tracker.campaignParams();r.conversion_name=t,r.price=e,n&&(r.order_number=n),interstate.tracker.sendMessage(r,"conversion")},interstate.tracker.trackGoal=function(t){interstate.tracker.trackConversion(t,0)},interstate.tracker.campaignParams=function(){var t,e,n,r,i,a={};return(t=interstate.cookie.getCookie("utm_campaign"))&&(a.utm_campaign=t),(e=interstate.cookie.getCookie("utm_medium"))&&(a.utm_medium=e),(n=interstate.cookie.getCookie("utm_source"))&&(a.utm_source=n),(r=interstate.cookie.getCookie("utm_term"))&&(a.utm_term=r),(i=interstate.cookie.getCookie("utm_content"))&&(a.utm_content=i),a.url_params=JSON.stringify(interstate.util.urlParams()),a},interstate.tracker.commonMessageData=function(){return{aliases:JSON.stringify(interstate.user.getAliases()),api_key:"ae2aeb935c2a8c7a80fb116093ef35ca",domain_name:window.location.hostname,location_path:window.location.pathname,project_key:interstate.passedData.projectToken,referrer_url:document.referrer,user_agent:window.navigator.userAgent,user_identifier:interstate.user.getIdentifier(),version_date:interstate.passedData.versionDate}},interstate.tracker.urlEncodeMessageData=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));var r=e.join("&").replace(/%20/g,"+");return r},interstate.tracker.sendMessage=function(t,e){var n=window.XDomainRequest?!0:!1,r="https:"===document.location.protocol?"https://":"http://",i=interstate.passedData.isStaging?"stagingapi":"api",a=r+i+".interstateanalytics.com/api/tracking/events/track";t.message_id=t.message_id||interstate.util.randomGUID(),t.event_name=e,t=interstate.util.extendObjects(t,interstate.tracker.commonMessageData());var s,o=interstate.tracker.urlEncodeMessageData(t);s=n?new window.XDomainRequest:window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),s.open("POST",a,!0),s.setRequestHeader&&s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send(o),interstate.logger.log("tracker","Sent message type "+e,t)};for(var i=0;i<interstate.singletons.length;i++){var singleton=interstate[interstate.singletons[i]];singleton&&singleton.initialize&&singleton.initialize()}interstate.async.runAllAsyncCalls(asyncCalls);for(var j=0;j<interstate.singletons.length;j++){var startingSingleton=interstate[interstate.singletons[i]];startingSingleton&&startingSingleton.start&&startingSingleton.start()}return interstate.api["export"]}.call({},this.interstate||[]);